{% extends "core/base.html" %} {% block content %}
<h1>Admin Dashboard</h1>
<p>Monitor class performance, manage balances, and review open wagers.</p>

<div class="stats">
  <div>Total Users: {{ total_users }}</div>
  <div>Total Wallet Balance: ${{ total_wallets }}</div>
  <div>Total Wagered: ${{ total_wagered }}</div>
  <div>Bookie Profit: ${{ bookie_profit }}</div>
</div>

<hr />

<h2>Students</h2>

<form method="get" class="filters">
  <input
    type="text"
    name="username"
    placeholder="Username"
    value="{{ request.GET.username }}"
  />
  <input
    type="text"
    name="email"
    placeholder="Email"
    value="{{ request.GET.email }}"
  />
  <button type="submit">Filter</button>
</form>

<table border="1" cellpadding="5" cellspacing="0">
  <thead>
    <tr>
      <th>ID</th>
      <th>Username</th>
      <th>Email</th>
      <th>Wallet Balance</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for user in users %}
    <tr>
      <td>{{ user.id }}</td>
      <td>{{ user.username }}</td>
      <td>{{ user.email }}</td>
      <td>${{ user.wallet_balance }}</td>
      <td>
        <a href="{% url 'edit_user' user.id %}">Edit</a> |
        <a
          href="{% url 'delete_user' user.id %}"
          onclick="return confirm('Delete this user?')"
          >Delete</a
        >
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="5">No students found.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<hr />

<h2>Bookie Wager Overview</h2>
<table border="1" cellpadding="5" cellspacing="0">
  <thead>
    <tr>
      <th>Date</th>
      <th>Intake</th>
      <th>Payout</th>
      <th>Profit</th>
    </tr>
  </thead>
  <tbody>
    {% for day, data in rows %}
    <tr>
      <td>{{ day }}</td>
      <td>${{ data.intake }}</td>
      <td>${{ data.payout }}</td>
      <td>${{ data.profit }}</td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="4">No wagers settled yet.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<hr />

<h2>Wagers</h2>
<form method="get" class="filters">
  <input
    type="text"
    name="username"
    placeholder="Username"
    value="{{ filters.username }}"
  />
  <input
    type="text"
    name="status"
    placeholder="Status"
    value="{{ filters.status }}"
  />
  <input
    type="date"
    name="date_from"
    placeholder="From"
    value="{{ filters.date_from }}"
  />
  <input
    type="date"
    name="date_to"
    placeholder="To"
    value="{{ filters.date_to }}"
  />
  <button type="submit">Filter</button>
</form>

<table border="1" cellpadding="5" cellspacing="0">
  <thead>
    <tr>
      <th>ID</th>
      <th>Student</th>
      <th>Amount</th>
      <th>Payout</th>
      <th>Status</th>
      <th>Placed At</th>
    </tr>
  </thead>
  <tbody>
    {% for wager in wagers %}
    <tr>
      <td>{{ wager.id }}</td>
      <td>{{ wager.user.username }}</td>
      <td>${{ wager.amount }}</td>
      <td>${{ wager.payout }}</td>
      <td>{{ wager.status }}</td>
      <td>{{ wager.placed_at }}</td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="6">No wagers found.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
